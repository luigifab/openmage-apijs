{"version":3,"sources":["apijs-openmage.js"],"sourcesContent":["/**\n * Created D/15/12/2013\n * Updated V/24/12/2021\n *\n * Copyright 2008-2022 | Fabrice Creuzot (luigifab) <code~luigifab~fr>\n * https://www.luigifab.fr/openmage/apijs\n *\n * This program is free software, you can redistribute it or modify\n * it under the terms of the GNU General Public License (GPL) as published\n * by the free software foundation, either version 2 of the license, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but without any warranty, without even the implied warranty of\n * merchantability or fitness for a particular purpose. See the\n * GNU General Public License (GPL) for more details.\n */\n\nvar apijsOpenMage = new (function () {\n\n\t\"use strict\";\n\n\tthis.init = function () {\n\n\t\tvar d = apijs.i18n.data;\n\t\tif (!d.frca) d.frca = {};\n\t\t// https://docs.google.com/spreadsheets/d/1UUpKZ-YAAlcfvGHYwt6aUM9io390j0-fIL0vMRh1pW0/edit?usp=sharing\n\t\t// auto start\n\t\td.cs[250] = \"Smazat soubor\";\n\t\td.cs[251] = \"Opravdu chcete tento soubor smazat?[br]Pozor, tuto operaci nelze vrátit zpět.\";\n\t\td.cs[252] = \"Chyba\";\n\t\td.cs[259] = \"Vymazat všechny soubory\";\n\t\td.cs[260] = \"Opravdu chcete smazat všechny soubory?[br]Pozor, tuto operaci nelze vrátit zpět.\";\n\t\td.cs[261] = \"Potvrďte zaškrtnutím políčka:\";\n\t\td.de[250] = \"Eine Datei löschen\";\n\t\td.de[251] = \"Sind Sie sicher, dass Sie diese Datei löschen möchten?[br]Achtung, diese Aktion ist unrückgängig.\";\n\t\td.de[252] = \"Fehler\";\n\t\td.de[253] = \"Sie verfügen nicht über die notwendigen Rechte um diese Operation durchzuführen, bitte [a §]aktualisieren Sie die Seite[/a].\";\n\t\td.de[254] = \"Es tut uns leid, diese Datei existiert nicht mehr, bitte [a §]aktualisieren Sie die Seite[/a].\";\n\t\td.de[259] = \"Alle Daten löschen\";\n\t\td.de[261] = \"Zur Bestätigung das Kontrollkästchen bestätigen:\";\n\t\td.el[252] = \"Σφάλμα\";\n\t\td.en[250] = \"Remove file\";\n\t\td.en[251] = \"Are you sure you want to remove this file?[br]Be careful, you can't cancel this operation.\";\n\t\td.en[252] = \"Error\";\n\t\td.en[253] = \"You are not authorized to perform this operation, please [a §]refresh the page[/a].\";\n\t\td.en[254] = \"Sorry, the file no longer exists, please [a §]refresh the page[/a].\";\n\t\td.en[255] = \"Clear cache\";\n\t\td.en[256] = \"Are you sure you want to clear the cache?[br]Be careful, you can't cancel this operation.\";\n\t\td.en[257] = \"Rename file\";\n\t\td.en[258] = \"Enter below the new name for the file.\";\n\t\td.en[259] = \"Remove all files\";\n\t\td.en[260] = \"Are you sure you want to remove all files?[br]Be careful, you can't cancel this operation.\";\n\t\td.en[261] = \"To confirm, check the checkbox:\";\n\t\td.es[250] = \"Borrar un archivo\";\n\t\td.es[251] = \"¿Está usted seguro(a) de que desea eliminar este archivo?[br]Atención, pues no podrá cancelar esta operación.\";\n\t\td.es[253] = \"No está autorizado-a para llevar a cabo esta operación, por favor [a §]actualice la página[/a].\";\n\t\td.es[254] = \"Disculpe, pero el archivo ya no existe, por favor [a §]actualice la página[/a].\";\n\t\td.es[255] = \"Vaciar la caché\";\n\t\td.es[256] = \"¿Está usted seguro(a) de querer vaciar la caché?[br]Cuidado, esta operación no puede ser cancelada.\";\n\t\td.frca[251] = \"Êtes-vous sûr(e) de vouloir supprimer ce fichier?[br]Attention, cette opération n'est pas annulable.\";\n\t\td.frca[256] = \"Êtes-vous certain(e) de vouloir vider le cache?[br]Attention, cette opération n'est pas annulable.\";\n\t\td.frca[260] = \"Êtes-vous sûr(e) de vouloir supprimer tous les fichiers?[br]Attention, cette opération n'est pas annulable.\";\n\t\td.fr[250] = \"Supprimer le fichier\";\n\t\td.fr[251] = \"Êtes-vous sûr(e) de vouloir supprimer ce fichier ?[br]Attention, cette opération n'est pas annulable.\";\n\t\td.fr[252] = \"Erreur\";\n\t\td.fr[253] = \"Vous n'êtes pas autorisé(e) à effectuer cette opération, veuillez [a §]actualiser la page[/a].\";\n\t\td.fr[254] = \"Désolé, le fichier n'existe plus, veuillez [a §]actualiser la page[/a].\";\n\t\td.fr[255] = \"Vider le cache\";\n\t\td.fr[256] = \"Êtes-vous certain(e) de vouloir vider le cache ?[br]Attention, cette opération n'est pas annulable.\";\n\t\td.fr[257] = \"Renommer le fichier\";\n\t\td.fr[258] = \"Saisissez ci-dessous le nouveau nom pour ce fichier.\";\n\t\td.fr[259] = \"Supprimer tous les fichiers\";\n\t\td.fr[260] = \"Êtes-vous sûr(e) de vouloir supprimer tous les fichiers ?[br]Attention, cette opération n'est pas annulable.\";\n\t\td.fr[261] = \"Pour confirmer, cochez la case :\";\n\t\td.hu[252] = \"Hiba\";\n\t\td.it[250] = \"Cancella i file\";\n\t\td.it[251] = \"Sei sicura di voler eliminare il file?[br]Attenzione, questa operazione non può essere annullata.\";\n\t\td.it[252] = \"Errore\";\n\t\td.it[253] = \"Non siete autorizzati a eseguire questa operazione, vi preghiamo di [a §]ricaricare la pagina[/a].\";\n\t\td.it[254] = \"Spiacenti, il file non esiste più, vi preghiamo di [a §]ricaricare la pagina[/a].\";\n\t\td.it[259] = \"Cancella tutti i file\";\n\t\td.it[260] = \"Sei sicura di voler cancellare tutti i file?[br]Attenzione, questa operazione non può essere annullata.\";\n\t\td.it[261] = \"Per confermare, seleziona la casella:\";\n\t\td.ja[250] = \"ファイルを削除\";\n\t\td.ja[252] = \"エラー\";\n\t\td.nl[252] = \"Fout\";\n\t\td.pl[250] = \"Usuń plik\";\n\t\td.pl[251] = \"Jesteś pewny, że chcesz usunąć ten plik?[br]Uwaga! Nie ma odwrotu od tej operacji.\";\n\t\td.pl[252] = \"Błąd\";\n\t\td.pl[259] = \"Usuń wszystkie pliki\";\n\t\td.pl[260] = \"Jesteś pewny, że chcesz usunąć ten plik?[br]Uwaga! Nie ma odwrotu od tej operacji.\";\n\t\td.pl[261] = \"Potwierdź twój wybór:\";\n\t\td.pt[250] = \"Suprimir um ficheiro\";\n\t\td.pt[251] = \"Tem certeza de que quer suprimir este ficheiro?[br]Cuidado, não pode cancelar esta operação.\";\n\t\td.pt[252] = \"Erro\";\n\t\td.pt[253] = \"Não é autorizado(a) para efetuar esta operação, por favor [a §]atualize a página[/a].\";\n\t\td.pt[254] = \"Lamento, o ficheiro já não existe, por favor [a §]atualize a página[/a].\";\n\t\td.ro[252] = \"Eroare\";\n\t\td.ru[250] = \"Удалить файл\";\n\t\td.ru[251] = \"Вы уверены, что хотите удалить этот файл?[br]Осторожно, вы не сможете отменить эту операцию.\";\n\t\td.ru[252] = \"Ошибка\";\n\t\td.ru[253] = \"Вы не авторизованы для выполнения этой операции, пожалуйста [a §]обновите страницу[/a].\";\n\t\td.ru[254] = \"Извините, но файл не существует, пожалуйста [a §]обновите страницу[/a].\";\n\t\td.sk[252] = \"Chyba\";\n\t\td.tr[252] = \"Hata\";\n\t\td.uk[252] = \"Помилка\";\n\t\td.zh[252] = \"错误信息\";\n\t\t// auto end\n\t};\n\n\tthis.error = function (data) {\n\n\t\tif ((typeof data == 'string') && (data.indexOf('<!DOCTYPE') < 0)) {\n\t\t\tif (apijs.dialog.has('upload'))\n\t\t\t\tapijs.upload.onError(false, data);\n\t\t\telse\n\t\t\t\tapijs.dialog.dialogInformation(apijs.i18n.translate(252), data, 'error');\n\t\t}\n\t\telse {\n\t\t\tapijs.dialog.remove('lock'); // obligatoire sinon demande de confirmation de quitter la page\n\t\t\tself.location.reload();\n\t\t}\n\t};\n\n\tthis.sendFiles = function (title, action, onemax, allmax, exts, extra) {\n\n\t\tapijs.upload.sendFiles(title, action, 'myimage', onemax, allmax, exts, apijsOpenMage.updateForm);\n\n\t\tif (typeof extra == 'string') {\n\t\t\tvar elem = document.createElement('p');\n\t\t\telem.innerHTML = '<label><input type=\"checkbox\" name=\"exclude\" /> ' + extra + '</label>';\n\t\t\tapijs.dialog.t2.appendChild(elem);\n\t\t}\n\t};\n\n\tthis.actionSave = function (action) {\n\n\t\tdocument.getElementById('apijsGallery').setAttribute('style', 'opacity:0.4; cursor:progress;');\n\n\t\tvar xhr = new XMLHttpRequest();\n\t\txhr.open('POST', action + '?isAjax=true', true);\n\t\txhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n\n\t\txhr.onreadystatechange = function () {\n\n\t\t\tif (xhr.readyState === 4) {\n\t\t\t\tif ([0, 200].has(xhr.status)) {\n\t\t\t\t\tif (xhr.responseText.indexOf('success-') === 0)\n\t\t\t\t\t\tapijsOpenMage.updateForm(xhr.responseText);\n\t\t\t\t\telse\n\t\t\t\t\t\tapijsOpenMage.error(xhr.responseText);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tapijsOpenMage.error(xhr.status);\n\t\t\t\t}\n\t\t\t\tdocument.getElementById('apijsGallery').removeAttribute('style');\n\t\t\t}\n\t\t};\n\n\t\txhr.send(apijs.serialize(document.getElementById('product_edit_form'), 'apijs'));\n\t};\n\n\tthis.updateForm = function (data, elem) {\n\n\t\t// success-{json[result, bbcode]}\n\t\tif (data.indexOf('{') > -1) {\n\t\t\tdata = JSON.parse(data.slice(data.indexOf('{')));\n\t\t\tif (data.bbcode)\n\t\t\t\tapijsOpenMage.error(data.bbcode);\n\t\t}\n\n\t\t// produit ou widget cms\n\t\tif (elem = document.getElementById('apijsGallery')) {\n\n\t\t\tif (data.filter = document.getElementById('apijsFilter'))\n\t\t\t\tdata.filter = parseInt(data.filter.value, 10);\n\n\t\t\telem.parentNode.innerHTML = data.html;\n\t\t\telem.querySelectorAll('input[type=\"checkbox\"], input[type=\"radio\"]').forEach(function (elem) {\n\t\t\t\telem.checked = elem.hasAttribute('checked');\n\t\t\t\tif (elem.hasAttribute('onchange'))\n\t\t\t\t\tapijsOpenMage.checkVal(elem);\n\t\t\t});\n\n\t\t\tapijs.slideshow.init();\n\t\t\tif (!apijs.dialog.has('error')) // ferme sauf en cas d'erreur\n\t\t\t\tapijs.dialog.actionClose();\n\n\t\t\tif (data.filter > 0) {\n\t\t\t\telem = document.getElementById('apijsFilter');\n\t\t\t\telem.value = data.filter;\n\t\t\t\telem.dispatchEvent(new Event('change'));\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tMediabrowserInstance.selectFolder(MediabrowserInstance.currentNode);\n\t\t}\n\t};\n\n\tthis.removeAttachment = function (action) {\n\t\tapijs.dialog.dialogConfirmation(apijs.i18n.translate(250), apijs.i18n.translate(251), apijsOpenMage.actionRemoveAttachment, action);\n\t};\n\n\tthis.removeAllAttachments = function (action) {\n\t\tapijs.dialog.dialogFormOptions(apijs.i18n.translate(259), apijs.i18n.translate(260) + '[p][label]' + apijs.i18n.translate(261) + ' [input type=\"checkbox\"][/label]', action, apijsOpenMage.actionRemoveAllAttachments);\n\t};\n\n\tthis.actionRemoveAttachment = function (args) {\n\n\t\t// args = action\n\t\tvar xhr = new XMLHttpRequest();\n\t\txhr.open('GET', args, true);\n\n\t\txhr.onreadystatechange = function () {\n\n\t\t\tif (xhr.readyState === 4) {\n\t\t\t\tif ([0, 200].has(xhr.status)) {\n\t\t\t\t\tif (xhr.responseText.indexOf('success-') === 0)\n\t\t\t\t\t\tapijsOpenMage.updateForm(xhr.responseText);\n\t\t\t\t\telse\n\t\t\t\t\t\tapijsOpenMage.error(xhr.responseText);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tapijsOpenMage.error(xhr.status);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\txhr.send();\n\t};\n\n\tthis.actionRemoveAllAttachments = function (action) {\n\n\t\tif (typeof action == 'boolean')\n\t\t\treturn apijs.html('input').checked;\n\n\t\tapijsOpenMage.actionRemoveAttachment(action);\n\t};\n\n\tthis.renameMedia = function (elem) {\n\n\t\telem = elem.parentNode.parentNode;\n\t\telem.click();\n\t\tif (!elem.classList.contains('selected'))\n\t\t\telem.click();\n\n\t\tvar name = elem.querySelector('.filename').textContent.trim(),\n\t\t    text = '[p][label for=\"apijsinput\"]' + apijs.i18n.translate(258) + '[/label][/p]' +\n\t\t\t\t'[input type=\"text\" name=\"name\" value=\"' + name + '\" spellcheck=\"false\" id=\"apijsinput\"]';\n\n\t\tapijs.dialog.dialogFormOptions(apijs.i18n.translate(257), text, 'action.php', apijsOpenMage.actionRenameMedia, elem.id, 'editname');\n\t\tapijs.dialog.t1.querySelector('input').select();\n\t};\n\n\tthis.actionRenameMedia = function (action, args) {\n\n\t\t// vérification de la nouvelle description\n\t\tif (typeof action == 'boolean') {\n\t\t\treturn true;\n\t\t}\n\t\t// sauvegarde du nouveau nom\n\t\telse if (typeof action == 'string') {\n\n\t\t\t// args = id\n\t\t\t// copie de MediabrowserInstance.deleteFiles(); ou presque\n\t\t\tvar xhr = new XMLHttpRequest();\n\t\t\txhr.open('POST', MediabrowserInstance.renameFileUrl + '?isAjax=true', true);\n\t\t\txhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n\n\t\t\txhr.onreadystatechange = function () {\n\n\t\t\t\tif (xhr.readyState === 4) {\n\t\t\t\t\tif ([0, 200].has(xhr.status)) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tMediabrowserInstance.onAjaxSuccess(xhr);\n\t\t\t\t\t\t\tMediabrowserInstance.selectFolder(MediabrowserInstance.currentNode);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcatch (e) {\n\t\t\t\t\t\t\tapijsOpenMage.error(e.message);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\txhr.send('form_key=' + FORM_KEY + '&file=' + encodeURIComponent(args) + '&name=' + encodeURIComponent(document.getElementById('apijsinput').value));\n\t\t}\n\t};\n\n\tthis.removeMedia = function (elem) {\n\n\t\telem = elem.parentNode.parentNode;\n\t\telem.click();\n\t\tif (!elem.classList.contains('selected'))\n\t\t\telem.click();\n\n\t\tapijs.dialog.dialogConfirmation(apijs.i18n.translate(250), apijs.i18n.translate(251), apijsOpenMage.actionRemoveMedia, elem.id);\n\t};\n\n\tthis.actionRemoveMedia = function (args) {\n\n\t\t// args = id\n\t\t// copie de MediabrowserInstance.deleteFiles(); ou presque\n\t\tvar xhr = new XMLHttpRequest();\n\t\txhr.open('POST', MediabrowserInstance.deleteFilesUrl + '?isAjax=true', true);\n\t\txhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n\n\t\txhr.onreadystatechange = function () {\n\n\t\t\tif (xhr.readyState === 4) {\n\t\t\t\tif ([0, 200].has(xhr.status)) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tMediabrowserInstance.onAjaxSuccess(xhr);\n\t\t\t\t\t\tMediabrowserInstance.selectFolder(MediabrowserInstance.currentNode);\n\t\t\t\t\t}\n\t\t\t\t\tcatch (e) {\n\t\t\t\t\t\tapijsOpenMage.error(e.message);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\txhr.send('form_key=' + FORM_KEY + '&file=' + encodeURIComponent(args));\n\t};\n\n\tthis.clearCache = function (action) {\n\t\tapijs.dialog.dialogConfirmation(apijs.i18n.translate(255), apijs.i18n.translate(256), apijsOpenMage.actionClearCache, action);\n\t};\n\n\tthis.actionClearCache = function (args) {\n\t\tapijs.dialog.remove('waiting', 'lock'); // obligatoire sinon demande de confirmation de quitter la page\n\t\tself.location.href = args;\n\t};\n\n\tthis.checkVal = function (root) {\n\n\t\tvar elem = root;\n\t\twhile ((elem.nodeName !== 'BODY') && !elem.querySelector('.val'))\n\t\t\telem = elem.parentNode;\n\n\t\tif (elem = elem.querySelector('.val')) {\n\t\t\tif (root.checked)\n\t\t\t\telem.setAttribute('disabled', 'disabled');\n\t\t\telse\n\t\t\t\telem.removeAttribute('disabled');\n\t\t}\n\t};\n\n\tthis.overloadMediabrowser = function () {\n\n\t\tvar elem, objs = [];\n\t\tif (typeof Mediabrowser == 'function')\n\t\t\tobjs.push(Mediabrowser);\n\t\tif (typeof MediabrowserInstance == 'object')\n\t\t\tobjs.push(MediabrowserInstance);\n\n\t\tobjs.forEach(function (obj) {\n\n\t\t\tif (typeof obj.origHideElement != 'function') {\n\n\t\t\t\tobj.origHideElement = obj.hideElement;\n\t\t\t\tobj.hideElement = function (name) {\n\t\t\t\t\tthis.origHideElement(name);\n\t\t\t\t\tif (name === 'loading-mask') {\n\t\t\t\t\t\tdocument.getElementById('loading-mask').classList.add('no-display');\n\t\t\t\t\t\tdocument.getElementById('contents').classList.remove('no-display');\n\t\t\t\t\t\tdocument.getElementById('contents-loader').classList.add('no-display');\n\t\t\t\t\t\tif (elem = document.querySelector('.main-col-inner .form-buttons'))\n\t\t\t\t\t\t\telem.removeAttribute('style');\n\t\t\t\t\t\tif (elem = document.querySelector('.content-header-floating .form-buttons'))\n\t\t\t\t\t\t\telem.removeAttribute('style');\n\t\t\t\t\t\tif (!apijs.dialog.has('error')) // ferme sauf en cas d'erreur\n\t\t\t\t\t\t\tapijs.dialog.actionClose();\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tobj.origShowElement = obj.showElement;\n\t\t\t\tobj.showElement = function (name) {\n\t\t\t\t\tthis.origShowElement(name);\n\t\t\t\t\tif (name === 'loading-mask') {\n\t\t\t\t\t\tdocument.getElementById('loading-mask').classList.add('no-display');\n\t\t\t\t\t\tdocument.getElementById('contents').classList.add('no-display');\n\t\t\t\t\t\tdocument.getElementById('contents-loader').classList.remove('no-display');\n\t\t\t\t\t\tif (elem = document.querySelector('.main-col-inner .form-buttons'))\n\t\t\t\t\t\t\telem.style.visibility = 'hidden';\n\t\t\t\t\t\tif (elem = document.querySelector('.content-header-floating .form-buttons'))\n\t\t\t\t\t\t\telem.style.visibility = 'hidden';\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tobj.origDrawBreadcrumbs = obj.drawBreadcrumbs;\n\t\t\t\tobj.drawBreadcrumbs = function (node) {\n\t\t\t\t\tthis.origDrawBreadcrumbs(node);\n\t\t\t\t\tif (!document.getElementById('breadcrumbs')) {\n\t\t\t\t\t\tnode = this.tree.getNodeById('root');\n\t\t\t\t\t\tdocument.getElementById('content_header').insert({ after: '<ul class=\"breadcrumbs\" id=\"breadcrumbs\"><li><a href=\"#\" onclick=\"MediabrowserInstance.selectFolderById(\\'' + node.id + '\\');\">' + node.text + '</a></li></ul>' });\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\n\t\tMediabrowserInstance.renameFileUrl   = MediabrowserInstance.deleteFilesUrl.replace(/[a-z_]+\\/deleteFiles\\//, 'apijs_wysiwyg/renameFile/');\n\t\tMediabrowserInstance.deleteFilesUrl  = MediabrowserInstance.deleteFilesUrl.replace(/[a-z_]+\\/deleteFiles\\//, 'apijs_wysiwyg/deleteFiles/');\n\t\tMediabrowserInstance.deleteFolderUrl = MediabrowserInstance.deleteFolderUrl.replace(/[a-z_]+\\/deleteFolder\\//, 'apijs_wysiwyg/deleteFolder/');\n\t};\n\n\tthis.filter = function (root) {\n\n\t\tvar word, text, show;\n\t\tif (typeof root == 'string') {\n\t\t\tshow = root;\n\t\t\troot = document.getElementById('apijsFilter');\n\t\t\tif (((root.value === show) && (show !== 'all')) || ((root.value === 'all') && (show === 'all')))\n\t\t\t\tshow = 'none';\n\t\t\troot.value = show;\n\t\t}\n\t\tif (root.nodeName === 'BUTTON') {\n\t\t\ttext = root.getAttribute('data-text');\n\t\t\troot.setAttribute('data-text', root.textContent);\n\t\t\troot.textContent = text;\n\t\t\troot.setAttribute('data-state', (root.getAttribute('data-state') == '0') ? '1' : '0');\n\t\t}\n\n\t\tdocument.getElementById('apijsGallery').querySelectorAll('tbody tr[id]').forEach(function (line) {\n\n\t\t\tshow = [];\n\n\t\t\t// pour chaque colonne (car toutes les colonnes peuvent avoir un filtre)\n\t\t\t// word = ce qu'on cherche dans la colonne courante\n\t\t\t// text = ce qu'il y a dans la cellule de la colonne de la ligne courante\n\t\t\tdocument.getElementById('apijsGallery').querySelectorAll('tr.filter th').forEach(function (col, idx) {\n\n\t\t\t\tcol = col.querySelector('.filter');\n\t\t\t\tif (!col) {\n\t\t\t\t\tshow.push(true);\n\t\t\t\t}\n\t\t\t\telse if (col.nodeName === 'SELECT') {\n\t\t\t\t\tword = Math.floor(parseInt(col.value, 10) / 100); // ce qu'on cherche\n\t\t\t\t\ttext = Math.floor(parseInt(line.querySelectorAll('td')[idx].querySelector('input.position').value, 10) / 100); //dans quoi\n\t\t\t\t\tshow.push((col.value === 'all') || (text == word));\n\t\t\t\t}\n\t\t\t\telse if (col.nodeName === 'BUTTON') {\n\t\t\t\t\tword = col.getAttribute('data-state') == '1'; // ce qu'on cherche\n\t\t\t\t\ttext = line.querySelectorAll('td')[idx].querySelector('input.check:not(.def)').checked; // dans quoi on cherche\n\t\t\t\t\tif (col.hasAttribute('data-reverse')) text = !text;\n\t\t\t\t\tshow.push(!word || (word && (word !== text)));\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// maintenant que chaque colonne de la ligne a été vérifiée\n\t\t\t// si aucune colonne indique qu'il ne faut pas afficher la ligne, on affiche la ligne\n\t\t\tline.setAttribute('style', (show.indexOf(false) > -1) ? 'display:none;' : '');\n\t\t\tline.removeAttribute('title');\n\t\t});\n\n\t\t// s'assure que le séparateur est visible\n\t\tif ((root.nodeName === 'SELECT') && !isNaN(root.value) && (root = document.querySelector('tr.grp' + root.value))) {\n\t\t\tvar rect = root.getBoundingClientRect();\n\t\t\tif ((rect.top < 0) && (rect.bottom <= window.innerHeight))\n\t\t\t\troot.scrollIntoView();\n\t\t}\n\t};\n\n})();\n\nif (typeof self.addEventListener == 'function')\n\tself.addEventListener('apijsload', apijsOpenMage.init.bind(apijsOpenMage));"],"names":["apijsOpenMage","this","init","d","apijs","i18n","data","frca","cs","de","el","en","es","fr","hu","it","ja","nl","pl","pt","ro","ru","sk","tr","uk","zh","error","indexOf","dialog","has","upload","onError","dialogInformation","translate","remove","self","location","reload","sendFiles","title","action","onemax","allmax","exts","extra","updateForm","elem","document","createElement","innerHTML","t2","appendChild","actionSave","getElementById","setAttribute","xhr","XMLHttpRequest","open","setRequestHeader","onreadystatechange","readyState","status","responseText","removeAttribute","send","serialize","JSON","parse","slice","bbcode","filter","parseInt","value","parentNode","html","querySelectorAll","forEach","checked","hasAttribute","checkVal","slideshow","actionClose","dispatchEvent","Event","MediabrowserInstance","selectFolder","currentNode","removeAttachment","dialogConfirmation","actionRemoveAttachment","removeAllAttachments","dialogFormOptions","actionRemoveAllAttachments","args","renameMedia","click","classList","contains","name","querySelector","textContent","trim","text","actionRenameMedia","id","t1","select","renameFileUrl","onAjaxSuccess","e","message","FORM_KEY","encodeURIComponent","removeMedia","actionRemoveMedia","deleteFilesUrl","clearCache","actionClearCache","href","root","nodeName","overloadMediabrowser","objs","Mediabrowser","push","obj","origHideElement","hideElement","add","origShowElement","showElement","style","visibility","origDrawBreadcrumbs","drawBreadcrumbs","node","tree","getNodeById","insert","after","replace","deleteFolderUrl","word","show","rect","getAttribute","line","col","idx","Math","floor","isNaN","getBoundingClientRect","top","bottom","window","innerHeight","scrollIntoView","addEventListener","bind"],"mappings":"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"}