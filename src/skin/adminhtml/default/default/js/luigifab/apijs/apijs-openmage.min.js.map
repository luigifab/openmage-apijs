{"version":3,"sources":["apijs-openmage.js"],"sourcesContent":["/**\n * Created D/15/12/2013\n * Updated D/05/09/2021\n *\n * Copyright 2008-2021 | Fabrice Creuzot (luigifab) <code~luigifab~fr>\n * https://www.luigifab.fr/openmage/apijs\n *\n * This program is free software, you can redistribute it or modify\n * it under the terms of the GNU General Public License (GPL) as published\n * by the free software foundation, either version 2 of the license, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but without any warranty, without even the implied warranty of\n * merchantability or fitness for a particular purpose. See the\n * GNU General Public License (GPL) for more details.\n */\n\nvar apijsOpenMage = new (function () {\n\n\t\"use strict\";\n\n\tthis.init = function () {\n\n\t\tvar d = apijs.i18n.data;\n\t\tif (!d.frca) d.frca = {};\n\t\t// https://docs.google.com/spreadsheets/d/1UUpKZ-YAAlcfvGHYwt6aUM9io390j0-fIL0vMRh1pW0/edit?usp=sharing\n\t\t// auto start\n\t\td.cs[250] = \"Smazat soubor\";\n\t\td.cs[251] = \"Opravdu chcete tento soubor smazat?[br]Pozor, tuto operaci nelze vrátit zpět.\";\n\t\td.cs[252] = \"Chyba\";\n\t\td.cs[259] = \"Vymazat všechny soubory\";\n\t\td.cs[260] = \"Opravdu chcete smazat všechny soubory?[br]Pozor, tuto operaci nelze vrátit zpět.\";\n\t\td.cs[261] = \"Potvrďte zaškrtnutím políčka:\";\n\t\td.de[250] = \"Eine Datei löschen\";\n\t\td.de[251] = \"Sind Sie sicher, dass Sie diese Datei löschen möchten?[br]Achtung, diese Aktion ist unrückgängig.\";\n\t\td.de[252] = \"Fehler\";\n\t\td.de[253] = \"Sie verfügen nicht über die notwendigen Rechte um diese Operation durchzuführen, bitte [a §]aktualisieren Sie die Seite[/a].\";\n\t\td.de[254] = \"Es tut uns leid, diese Datei existiert nicht mehr, bitte [a §]aktualisieren Sie die Seite[/a].\";\n\t\td.de[259] = \"Alle Daten löschen\";\n\t\td.de[261] = \"Zur Bestätigung das Kontrollkästchen bestätigen:\";\n\t\td.en[250] = \"Remove file\";\n\t\td.en[251] = \"Are you sure you want to remove this file?[br]Be careful, you can't cancel this operation.\";\n\t\td.en[252] = \"Error\";\n\t\td.en[253] = \"You are not authorized to perform this operation, please [a §]refresh the page[/a].\";\n\t\td.en[254] = \"Sorry, the file no longer exists, please [a §]refresh the page[/a].\";\n\t\td.en[255] = \"Clear cache\";\n\t\td.en[256] = \"Are you sure you want to clear the cache?[br]Be careful, you can't cancel this operation.\";\n\t\td.en[257] = \"Rename file\";\n\t\td.en[258] = \"Enter below the new name for the file.\";\n\t\td.en[259] = \"Remove all files\";\n\t\td.en[260] = \"Are you sure you want to remove all files?[br]Be careful, you can't cancel this operation.\";\n\t\td.en[261] = \"To confirm, check the checkbox:\";\n\t\td.es[250] = \"Borrar un archivo\";\n\t\td.es[251] = \"¿Está usted seguro(a) de que desea eliminar este archivo?[br]Atención, pues no podrá cancelar esta operación.\";\n\t\td.es[253] = \"No está autorizado-a para llevar a cabo esta operación, por favor [a §]actualice la página[/a].\";\n\t\td.es[254] = \"Disculpe, pero el archivo ya no existe, por favor [a §]actualice la página[/a].\";\n\t\td.es[255] = \"Vaciar la caché\";\n\t\td.es[256] = \"¿Está usted seguro(a) de querer vaciar la caché?[br]Cuidado, esta operación no puede ser cancelada.\";\n\t\td.frca[251] = \"Êtes-vous sûr(e) de vouloir supprimer ce fichier?[br]Attention, cette opération n'est pas annulable.\";\n\t\td.frca[256] = \"Êtes-vous certain(e) de vouloir vider le cache?[br]Attention, cette opération n'est pas annulable.\";\n\t\td.frca[260] = \"Êtes-vous sûr(e) de vouloir supprimer tous les fichiers?[br]Attention, cette opération n'est pas annulable.\";\n\t\td.fr[250] = \"Supprimer le fichier\";\n\t\td.fr[251] = \"Êtes-vous sûr(e) de vouloir supprimer ce fichier ?[br]Attention, cette opération n'est pas annulable.\";\n\t\td.fr[252] = \"Erreur\";\n\t\td.fr[253] = \"Vous n'êtes pas autorisé(e) à effectuer cette opération, veuillez [a §]actualiser la page[/a].\";\n\t\td.fr[254] = \"Désolé, le fichier n'existe plus, veuillez [a §]actualiser la page[/a].\";\n\t\td.fr[255] = \"Vider le cache\";\n\t\td.fr[256] = \"Êtes-vous certain(e) de vouloir vider le cache ?[br]Attention, cette opération n'est pas annulable.\";\n\t\td.fr[257] = \"Renommer le fichier\";\n\t\td.fr[258] = \"Saisissez ci-dessous le nouveau nom pour ce fichier.\";\n\t\td.fr[259] = \"Supprimer tous les fichiers\";\n\t\td.fr[260] = \"Êtes-vous sûr(e) de vouloir supprimer tous les fichiers ?[br]Attention, cette opération n'est pas annulable.\";\n\t\td.fr[261] = \"Pour confirmer, cochez la case :\";\n\t\td.it[250] = \"Cancella i file\";\n\t\td.it[251] = \"Sei sicura di voler eliminare il file?[br]Attenzione, questa operazione non può essere annullata.\";\n\t\td.it[252] = \"Errore\";\n\t\td.it[253] = \"Non siete autorizzati a eseguire questa operazione, vi preghiamo di [a §]ricaricare la pagina[/a].\";\n\t\td.it[254] = \"Spiacenti, il file non esiste più, vi preghiamo di [a §]ricaricare la pagina[/a].\";\n\t\td.it[259] = \"Cancella tutti i file\";\n\t\td.it[260] = \"Sei sicura di voler cancellare tutti i file?[br]Attenzione, questa operazione non può essere annullata.\";\n\t\td.it[261] = \"Per confermare, seleziona la casella:\";\n\t\td.ja[250] = \"ファイルを削除\";\n\t\td.ja[252] = \"エラー\";\n\t\td.nl[252] = \"Fout\";\n\t\td.pl[250] = \"Usuń plik\";\n\t\td.pl[251] = \"Jesteś pewny, że chcesz usunąć ten plik?[br]Uwaga! Nie ma odwrotu od tej operacji.\";\n\t\td.pl[252] = \"Błąd\";\n\t\td.pl[259] = \"Usuń wszystkie pliki\";\n\t\td.pl[260] = \"Jesteś pewny, że chcesz usunąć ten plik?[br]Uwaga! Nie ma odwrotu od tej operacji.\";\n\t\td.pl[261] = \"Potwierdź twój wybór:\";\n\t\td.pt[250] = \"Suprimir um ficheiro\";\n\t\td.pt[251] = \"Tem certeza de que quer suprimir este ficheiro?[br]Cuidado, não pode cancelar esta operação.\";\n\t\td.pt[252] = \"Erro\";\n\t\td.pt[253] = \"Não é autorizado(a) para efetuar esta operação, por favor [a §]atualize a página[/a].\";\n\t\td.pt[254] = \"Lamento, o ficheiro já não existe, por favor [a §]atualize a página[/a].\";\n\t\td.ru[250] = \"Удалить файл\";\n\t\td.ru[251] = \"Вы уверены, что хотите удалить этот файл?[br]Осторожно, вы не сможете отменить эту операцию.\";\n\t\td.ru[252] = \"Ошибка\";\n\t\td.ru[253] = \"Вы не авторизованы для выполнения этой операции, пожалуйста [a §]обновите страницу[/a].\";\n\t\td.ru[254] = \"Извините, но файл не существует, пожалуйста [a §]обновите страницу[/a].\";\n\t\td.sk[252] = \"Chyba\";\n\t\td.tr[252] = \"Hata\";\n\t\td.uk[252] = \"Помилка\";\n\t\td.zh[252] = \"错误信息\";\n\t\t// auto end\n\t};\n\n\tthis.error = function (data) {\n\n\t\tif ((typeof data == 'string') && (data.indexOf('<!DOCTYPE') < 0)) {\n\t\t\tif (apijs.dialog.has('upload'))\n\t\t\t\tapijs.upload.onError(false, data);\n\t\t\telse\n\t\t\t\tapijs.dialog.dialogInformation(apijs.i18n.translate(252), data, 'error');\n\t\t}\n\t\telse {\n\t\t\tapijs.dialog.remove('lock'); // obligatoire sinon demande de confirmation de quitter la page\n\t\t\tself.location.reload();\n\t\t}\n\t};\n\n\tthis.sendFiles = function (title, action, onemax, allmax, extra) {\n\n\t\tapijs.upload.sendFiles(title, action, 'myimage', onemax, allmax, 'jpg,jpeg,gif,png,svg', apijsOpenMage.updateForm);\n\n\t\tif (typeof extra == 'string') {\n\t\t\tvar elem = document.createElement('p');\n\t\t\telem.innerHTML = '<label><input type=\"checkbox\" name=\"exclude\" /> ' + extra + '</label>';\n\t\t\tapijs.dialog.t2.appendChild(elem);\n\t\t}\n\t};\n\n\tthis.actionSave = function (action) {\n\n\t\tdocument.getElementById('apijsGallery').setAttribute('style', 'opacity:0.4; cursor:progress;');\n\n\t\t// traitement ajax\n\t\tvar xhr = new XMLHttpRequest();\n\t\txhr.open('POST', action + '?isAjax=true', true);\n\t\txhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n\n\t\txhr.onreadystatechange = function () {\n\n\t\t\tif (xhr.readyState === 4) {\n\t\t\t\tif ([0, 200].has(xhr.status)) {\n\t\t\t\t\tif (xhr.responseText.indexOf('success-') === 0)\n\t\t\t\t\t\tapijsOpenMage.updateForm(xhr.responseText);\n\t\t\t\t\telse\n\t\t\t\t\t\tapijsOpenMage.error(xhr.responseText);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tapijsOpenMage.error(xhr.status);\n\t\t\t\t}\n\t\t\t\tdocument.getElementById('apijsGallery').removeAttribute('style');\n\t\t\t}\n\t\t};\n\n\t\txhr.send(apijs.serialize(document.getElementById('product_edit_form'), 'apijs'));\n\t};\n\n\tthis.updateForm = function (data, elem) {\n\n\t\t// success-{json[result, bbcode]}\n\t\tif (data.indexOf('{') > -1) {\n\t\t\tdata = JSON.parse(data.slice(data.indexOf('{')));\n\t\t\tif (data.bbcode)\n\t\t\t\tapijsOpenMage.error(data.bbcode);\n\t\t}\n\n\t\t// produit ou widget cms\n\t\tif (elem = document.getElementById('apijsGallery')) {\n\n\t\t\tif (data.filter = document.getElementById('apijsFilter'))\n\t\t\t\tdata.filter = parseInt(data.filter.value, 10);\n\n\t\t\telem.parentNode.innerHTML = data.html;\n\t\t\telem.querySelectorAll('input[type=\"checkbox\"], input[type=\"radio\"]').forEach(function (elem) {\n\t\t\t\telem.checked = elem.hasAttribute('checked');\n\t\t\t\tif (elem.hasAttribute('onchange'))\n\t\t\t\t\tapijsOpenMage.checkVal(elem);\n\t\t\t});\n\n\t\t\tapijs.slideshow.init();\n\t\t\tif (!apijs.dialog.has('error')) // ferme sauf en cas d'erreur\n\t\t\t\tapijs.dialog.actionClose();\n\n\t\t\tif (data.filter > 0) {\n\t\t\t\telem = document.getElementById('apijsFilter');\n\t\t\t\telem.value = data.filter;\n\t\t\t\telem.dispatchEvent(new Event('change'));\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tMediabrowserInstance.selectFolder(MediabrowserInstance.currentNode);\n\t\t}\n\t};\n\n\tthis.removeAttachment = function (action) {\n\t\tapijs.dialog.dialogConfirmation(apijs.i18n.translate(250), apijs.i18n.translate(251), apijsOpenMage.actionRemoveAttachment, action);\n\t};\n\n\tthis.removeAllAttachments = function (action) {\n\t\tapijs.dialog.dialogFormOptions(apijs.i18n.translate(259), apijs.i18n.translate(260) + '[p][label]' + apijs.i18n.translate(261) + ' [input type=\"checkbox\"][/label]', action, apijsOpenMage.actionRemoveAllAttachments);\n\t};\n\n\tthis.actionRemoveAttachment = function (args) {\n\n\t\t// args = action\n\t\tvar xhr = new XMLHttpRequest();\n\t\txhr.open('GET', args, true);\n\n\t\txhr.onreadystatechange = function () {\n\n\t\t\tif (xhr.readyState === 4) {\n\t\t\t\tif ([0, 200].has(xhr.status)) {\n\t\t\t\t\tif (xhr.responseText.indexOf('success-') === 0)\n\t\t\t\t\t\tapijsOpenMage.updateForm(xhr.responseText);\n\t\t\t\t\telse\n\t\t\t\t\t\tapijsOpenMage.error(xhr.responseText);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tapijsOpenMage.error(xhr.status);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\txhr.send();\n\t};\n\n\tthis.actionRemoveAllAttachments = function (action) {\n\n\t\tif (typeof action == 'boolean')\n\t\t\treturn apijs.html('input').checked;\n\n\t\tapijsOpenMage.actionRemoveAttachment(action);\n\t};\n\n\tthis.renameMedia = function (elem) {\n\n\t\telem = elem.parentNode.parentNode;\n\t\telem.click();\n\t\tif (!elem.classList.contains('selected'))\n\t\t\telem.click();\n\n\t\tvar name = elem.querySelector('.filename').textContent.trim(),\n\t\t    text = '[p][label for=\"apijsinput\"]' + apijs.i18n.translate(258) + '[/label][/p]' +\n\t\t\t\t'[input type=\"text\" name=\"name\" value=\"' + name + '\" spellcheck=\"false\" id=\"apijsinput\"]';\n\n\t\tapijs.dialog.dialogFormOptions(apijs.i18n.translate(257), text, 'action.php', apijsOpenMage.actionRenameMedia, elem.id, 'editname');\n\t};\n\n\tthis.actionRenameMedia = function (action, args) {\n\n\t\t// vérification de la nouvelle description\n\t\tif (typeof action == 'boolean') {\n\t\t\treturn true;\n\t\t}\n\t\t// sauvegarde du nouveau nom\n\t\telse if (typeof action == 'string') {\n\n\t\t\t// args = id\n\t\t\t// copie de MediabrowserInstance.deleteFiles(); ou presque\n\t\t\tnew Ajax.Request(MediabrowserInstance.renameFileUrl, {\n\t\t\t\tparameters: { file: args, name: document.getElementById('apijsinput').value },\n\t\t\t\tonSuccess: function (transport) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tMediabrowserInstance.onAjaxSuccess(transport);\n\t\t\t\t\t\tMediabrowserInstance.selectFolder(MediabrowserInstance.currentNode);\n\t\t\t\t\t}\n\t\t\t\t\tcatch (e) {\n\t\t\t\t\t\tapijsOpenMage.error(e.message);\n\t\t\t\t\t}\n\t\t\t\t}.bind(MediabrowserInstance)\n\t\t\t});\n\t\t}\n\t};\n\n\tthis.removeMedia = function (elem) {\n\n\t\telem = elem.parentNode.parentNode;\n\t\telem.click();\n\t\tif (!elem.classList.contains('selected'))\n\t\t\telem.click();\n\n\t\tapijs.dialog.dialogConfirmation(apijs.i18n.translate(250), apijs.i18n.translate(251), apijsOpenMage.actionRemoveMedia, elem.id);\n\t};\n\n\tthis.actionRemoveMedia = function (args) {\n\n\t\t// args = id\n\t\t// copie de MediabrowserInstance.deleteFiles(); ou presque\n\t\tnew Ajax.Request(MediabrowserInstance.deleteFilesUrl, {\n\t\t\tparameters: { files: Object.toJSON([args]) },\n\t\t\tonSuccess: function (transport) {\n\t\t\t\ttry {\n\t\t\t\t\tMediabrowserInstance.onAjaxSuccess(transport);\n\t\t\t\t\tMediabrowserInstance.selectFolder(MediabrowserInstance.currentNode);\n\t\t\t\t}\n\t\t\t\tcatch (e) {\n\t\t\t\t\tapijsOpenMage.error(e.message);\n\t\t\t\t}\n\t\t\t}.bind(MediabrowserInstance)\n\t\t});\n\t};\n\n\tthis.clearCache = function (action) {\n\t\tapijs.dialog.dialogConfirmation(apijs.i18n.translate(255), apijs.i18n.translate(256), apijsOpenMage.actionClearCache, action);\n\t};\n\n\tthis.actionClearCache = function (args) {\n\t\tapijs.dialog.remove('waiting', 'lock'); // obligatoire sinon demande de confirmation de quitter la page\n\t\tself.location.href = args;\n\t};\n\n\tthis.checkVal = function (root) {\n\n\t\tvar elem = root;\n\t\twhile ((elem.nodeName !== 'BODY') && !elem.querySelector('.val'))\n\t\t\telem = elem.parentNode;\n\n\t\tif (elem = elem.querySelector('.val')) {\n\t\t\tif (root.checked)\n\t\t\t\telem.setAttribute('disabled', 'disabled');\n\t\t\telse\n\t\t\t\telem.removeAttribute('disabled');\n\t\t}\n\t};\n\n\tthis.overloadMediabrowser = function () {\n\n\t\tvar elem, objs = [];\n\t\tif (typeof Mediabrowser == 'function')\n\t\t\tobjs.push(Mediabrowser);\n\t\tif (typeof MediabrowserInstance == 'object')\n\t\t\tobjs.push(MediabrowserInstance);\n\n\t\tobjs.forEach(function (obj) {\n\n\t\t\tif (typeof obj.origHideElement != 'function') {\n\n\t\t\t\tobj.origHideElement = obj.hideElement;\n\t\t\t\tobj.hideElement = function (name) {\n\t\t\t\t\tthis.origHideElement(name);\n\t\t\t\t\tif (name === 'loading-mask') {\n\t\t\t\t\t\tdocument.getElementById('loading-mask').classList.add('no-display');\n\t\t\t\t\t\tdocument.getElementById('contents').classList.remove('no-display');\n\t\t\t\t\t\tdocument.getElementById('contents-loader').classList.add('no-display');\n\t\t\t\t\t\tif (elem = document.querySelector('.main-col-inner .form-buttons'))\n\t\t\t\t\t\t\telem.removeAttribute('style');\n\t\t\t\t\t\tif (elem = document.querySelector('.content-header-floating .form-buttons'))\n\t\t\t\t\t\t\telem.removeAttribute('style');\n\t\t\t\t\t\tif (!apijs.dialog.has('error')) // ferme sauf en cas d'erreur\n\t\t\t\t\t\t\tapijs.dialog.actionClose();\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tobj.origShowElement = obj.showElement;\n\t\t\t\tobj.showElement = function (name) {\n\t\t\t\t\tthis.origShowElement(name);\n\t\t\t\t\tif (name === 'loading-mask') {\n\t\t\t\t\t\tdocument.getElementById('loading-mask').classList.add('no-display');\n\t\t\t\t\t\tdocument.getElementById('contents').classList.add('no-display');\n\t\t\t\t\t\tdocument.getElementById('contents-loader').classList.remove('no-display');\n\t\t\t\t\t\tif (elem = document.querySelector('.main-col-inner .form-buttons'))\n\t\t\t\t\t\t\telem.style.visibility = 'hidden';\n\t\t\t\t\t\tif (elem = document.querySelector('.content-header-floating .form-buttons'))\n\t\t\t\t\t\t\telem.style.visibility = 'hidden';\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tobj.origDrawBreadcrumbs = obj.drawBreadcrumbs;\n\t\t\t\tobj.drawBreadcrumbs = function (node) {\n\t\t\t\t\tthis.origDrawBreadcrumbs(node);\n\t\t\t\t\tif (!document.getElementById('breadcrumbs')) {\n\t\t\t\t\t\tnode = this.tree.getNodeById('root');\n\t\t\t\t\t\tdocument.getElementById('content_header').insert({ after: '<ul class=\"breadcrumbs\" id=\"breadcrumbs\"><li><a href=\"#\" onclick=\"MediabrowserInstance.selectFolderById(\\'' + node.id + '\\');\">' + node.text + '</a></li></ul>' });\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\n\t\tMediabrowserInstance.renameFileUrl   = MediabrowserInstance.deleteFilesUrl.replace(/[a-z_]+\\/deleteFiles\\//, 'apijs_wysiwyg/renameFile/');\n\t\tMediabrowserInstance.deleteFilesUrl  = MediabrowserInstance.deleteFilesUrl.replace(/[a-z_]+\\/deleteFiles\\//, 'apijs_wysiwyg/deleteFiles/');\n\t\tMediabrowserInstance.deleteFolderUrl = MediabrowserInstance.deleteFolderUrl.replace(/[a-z_]+\\/deleteFolder\\//, 'apijs_wysiwyg/deleteFolder/');\n\t};\n\n\tthis.filter = function (root) {\n\n\t\tvar word, text, show;\n\t\tif (typeof root == 'string') {\n\t\t\tshow = root;\n\t\t\troot = document.getElementById('apijsFilter');\n\t\t\tif (((root.value === show) && (show !== 'all')) || ((root.value === 'all') && (show === 'all')))\n\t\t\t\tshow = 'none';\n\t\t\troot.value = show;\n\t\t}\n\t\tif (root.nodeName === 'BUTTON') {\n\t\t\ttext = root.getAttribute('data-text');\n\t\t\troot.setAttribute('data-text', root.textContent);\n\t\t\troot.textContent = text;\n\t\t\troot.setAttribute('data-state', (root.getAttribute('data-state') == '0') ? '1' : '0');\n\t\t}\n\n\t\tdocument.getElementById('apijsGallery').querySelectorAll('tbody tr[id]').forEach(function (line) {\n\n\t\t\tshow = [];\n\n\t\t\t// pour chaque colonne (car toutes les colonnes peuvent avoir un filtre)\n\t\t\t// word = ce qu'on cherche dans la colonne courante\n\t\t\t// text = ce qu'il y a dans la cellule de la colonne de la ligne courante\n\t\t\tdocument.getElementById('apijsGallery').querySelectorAll('tr.filter th').forEach(function (col, idx) {\n\n\t\t\t\tcol = col.querySelector('.filter');\n\t\t\t\tif (!col) {\n\t\t\t\t\tshow.push(true);\n\t\t\t\t}\n\t\t\t\telse if (col.nodeName === 'SELECT') {\n\t\t\t\t\tword = Math.floor(parseInt(col.value, 10) / 100); // ce qu'on cherche\n\t\t\t\t\ttext = Math.floor(parseInt(line.querySelectorAll('td')[idx].querySelector('input.position').value, 10) / 100); //dans quoi\n\t\t\t\t\tshow.push((col.value === 'all') || (text == word));\n\t\t\t\t}\n\t\t\t\telse if (col.nodeName === 'BUTTON') {\n\t\t\t\t\tword = col.getAttribute('data-state') == '1'; // ce qu'on cherche\n\t\t\t\t\ttext = line.querySelectorAll('td')[idx].querySelector('input.check:not(.def)').checked; // dans quoi on cherche\n\t\t\t\t\tif (col.hasAttribute('data-reverse')) text = !text;\n\t\t\t\t\tshow.push(!word || (word && (word !== text)));\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// maintenant que chaque colonne de la ligne a été vérifiée\n\t\t\t// si aucune colonne indique qu'il ne faut pas afficher la ligne, on affiche la ligne\n\t\t\tline.setAttribute('style', (show.indexOf(false) > -1) ? 'display:none;' : '');\n\t\t\tline.removeAttribute('title');\n\t\t});\n\n\t\t// s'assure que le séparateur est visible\n\t\tif ((root.nodeName === 'SELECT') && !isNaN(root.value) && (root = document.querySelector('tr.grp' + root.value))) {\n\t\t\tvar rect = root.getBoundingClientRect();\n\t\t\tif ((rect.top < 0) && (rect.bottom <= window.innerHeight))\n\t\t\t\troot.scrollIntoView();\n\t\t}\n\t};\n\n})();\n\nif (typeof self.addEventListener == 'function')\n\tself.addEventListener('apijsload', apijsOpenMage.init.bind(apijsOpenMage));"],"names":["apijsOpenMage","this","init","d","apijs","i18n","data","frca","cs","de","en","es","fr","it","ja","nl","pl","pt","ru","sk","tr","uk","zh","error","indexOf","dialog","has","upload","onError","dialogInformation","translate","remove","self","location","reload","sendFiles","title","action","onemax","allmax","extra","updateForm","elem","document","createElement","innerHTML","t2","appendChild","actionSave","getElementById","setAttribute","xhr","XMLHttpRequest","open","setRequestHeader","onreadystatechange","readyState","status","responseText","removeAttribute","send","serialize","JSON","parse","slice","bbcode","filter","parseInt","value","parentNode","html","querySelectorAll","forEach","checked","hasAttribute","checkVal","slideshow","actionClose","dispatchEvent","Event","MediabrowserInstance","selectFolder","currentNode","removeAttachment","dialogConfirmation","actionRemoveAttachment","removeAllAttachments","dialogFormOptions","actionRemoveAllAttachments","args","renameMedia","click","classList","contains","name","querySelector","textContent","trim","text","actionRenameMedia","id","Ajax","Request","renameFileUrl","parameters","file","onSuccess","transport","onAjaxSuccess","e","message","bind","removeMedia","actionRemoveMedia","deleteFilesUrl","files","Object","toJSON","clearCache","actionClearCache","href","root","nodeName","overloadMediabrowser","objs","Mediabrowser","push","obj","origHideElement","hideElement","add","origShowElement","showElement","style","visibility","origDrawBreadcrumbs","drawBreadcrumbs","node","tree","getNodeById","insert","after","replace","deleteFolderUrl","word","show","rect","getAttribute","line","col","idx","Math","floor","isNaN","getBoundingClientRect","top","bottom","window","innerHeight","scrollIntoView","addEventListener"],"mappings":"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"}